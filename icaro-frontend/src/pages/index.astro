---
import BaseLayout from "@/layouts/BaseLayout.astro";
import Header from "@/components/CCommon/Header.astro";
import NavBar from "@/components/CCommon/NavBar.astro";
import TopUtility from "@/components/CCommon/TopUtility.astro";
import IndexInfo from "@/components/CIndex/IndexInfo.astro";
import "@/styles/index.css";
import epslimage from "@/assets/epslportada.webp";
import Carousel from "@/components/CIndex/Carousel.astro";
---

<BaseLayout>
  <section class="w-full bg-white shadow-md rounded-lg">
    <TopUtility />
    <Header />
  </section>

  <section class="my-6 sm:my-8 md:my-10 w-full bg-white shadow-md">
    <NavBar />
  </section>

  <section class="w-full bg-white shadow-md">
    <div class="relative w-full overflow-hidden">
      <!-- Loader de la imagen -->
      <div
        id="image-loader"
        class="absolute inset-0 bg-gray-100 flex items-center justify-center"
      >
        <div
          class="animate-spin rounded-full h-12 w-12 border-t-4 border-b-4 border-[#006D38]"
        >
        </div>
      </div>

      <!-- Imagen (oculta inicialmente) -->
      <img
        id="main-image"
        src={epslimage.src}
        alt="EPSL Logo"
        class="w-full h-auto opacity-0 transition-opacity duration-500"
      />
    </div>
  </section>

  <section
    class="w-full content-wrap bg-white shadow-md px-4 sm:px-6 lg:px-8 py-4 sm:py-12 md:py-10 lg:py-15"
  >
    <div class="mb-4 sm:mb-4 relative inline-block w-full text-center">
      <h2 class="text-xl sm:text-2xl md:text-3xl font-bold text-[#231F20] pb-2">
        Grupo de Investigaci√≥n
      </h2>
      <span
        class="absolute left-1/2 bottom-0 w-16 sm:w-20 h-1 bg-[#006D38] -translate-x-1/2"
      ></span>
    </div>
    <IndexInfo />
  </section>

  <section
    class="w-full content-wrap bg-white shadow-md px-4 sm:px-6 lg:px-8 py-5 sm:py-7 md:py-10 lg:py-10"
  >
    <div class="mb-4 sm:mb-6 relative inline-block w-full text-center">
      <h2 class="text-xl sm:text-2xl md:text-3xl font-bold text-[#231F20] pb-2">
        Investigaciones recientes
      </h2>
      <span
        class="absolute left-1/2 bottom-0 w-16 sm:w-20 h-1 bg-[#006D38] -translate-x-1/2"
      ></span>
    </div>
    <Carousel />
  </section>
</BaseLayout>

<script>
    const mainImage = document.getElementById('main-image') as HTMLImageElement;
    const imageLoader = document.getElementById('image-loader');

    if (mainImage && imageLoader) {
      mainImage.addEventListener('load', () => {
        imageLoader.style.display = 'none';
        mainImage.classList.remove('opacity-0');
        mainImage.classList.add('opacity-100');
      });

      if (mainImage.complete) {
        imageLoader.style.display = 'none';
        mainImage.classList.add('opacity-100');
      }
    }
  </script>