---
import BaseLayout from "@/layouts/BaseLayout.astro";
import TopUtility from "@/components/TopUtility.astro";
import NavBar from "@/components/NavBar.astro";
import Header from "@/components/Header.astro";
import YearGroup from "@/components/YearGroup.astro";

const researchGroups = [
  {
    year: 2025,
    items: [
      {
        title: "Trustworthy and explainable federated system for extracting descriptive rules in a data streaming environment",
        authors: [
          "María Asunción Padilla Rascón",
          "Ángel Miguel García-Vico",
          "Cristóbal J. Carmona"
        ],
        links: { doi: "#", scholar: "#", bibtex: "#" }
      },
      {
        title: "Extracting Knowledge from Machine Learning Models to Diagnose Breast Cancer",
        authors: [
          "José Martínez-Ramírez",
          "Cristóbal J. Carmona",
          "María Ramírez-Expósito",
          "José Martínez-Martos"
        ],
        links: { doi: "#", scholar: "#", bibtex: "#" }
      },
      {
        title: "Application of Spiking Neural Networks and Traditional Artificial Neural Networks for Solar Radiation Forecasting in Photovoltaic Systems in Arab Countries",
        authors: [
          "Bahgat Ayasi",
          "Iago Vázquez",
          "Mohammed Saleh",
          "Ángel Miguel García-Vico",
          "Cristóbal J. Carmona"
        ],
        links: { doi: "#", scholar: "#", bibtex: "#" }
      },
      {
        title: "Application of Spiking Neural Networks and Traditional Artificial Neural Networks for Solar Radiation Forecasting in Photovoltaic Systems in Arab Countries",
        authors: [
          "Bahgat Ayasi",
          "Iago Vázquez",
          "Mohammed Saleh",
          "Ángel Miguel García-Vico",
          "Cristóbal J. Carmona"
        ],
        links: { doi: "#", scholar: "#", bibtex: "#" }
      },
      {
        title: "Application of Spiking Neural Networks and Traditional Artificial Neural Networks for Solar Radiation Forecasting in Photovoltaic Systems in Arab Countries",
        authors: [
          "Bahgat Ayasi",
          "Iago Vázquez",
          "Mohammed Saleh",
          "Ángel Miguel García-Vico",
          "Cristóbal J. Carmona"
        ],
        links: { doi: "#", scholar: "#", bibtex: "#" }
      },
      {
        title: "Application of Spiking Neural Networks and Traditional Artificial Neural Networks for Solar Radiation Forecasting in Photovoltaic Systems in Arab Countries",
        authors: [
          "Bahgat Ayasi",
          "Iago Vázquez",
          "Mohammed Saleh",
          "Ángel Miguel García-Vico",
          "Cristóbal J. Carmona"
        ],
        links: { doi: "#", scholar: "#", bibtex: "#" }
      },
      {
        title: "Application of Spiking Neural Networks and Traditional Artificial Neural Networks for Solar Radiation Forecasting in Photovoltaic Systems in Arab Countries",
        authors: [
          "Bahgat Ayasi",
          "Iago Vázquez",
          "Mohammed Saleh",
          "Ángel Miguel García-Vico",
          "Cristóbal J. Carmona"
        ],
        links: { doi: "#", scholar: "#", bibtex: "#" }
      },
      {
        title: "Application of Spiking Neural Networks and Traditional Artificial Neural Networks for Solar Radiation Forecasting in Photovoltaic Systems in Arab Countries",
        authors: [
          "Bahgat Ayasi",
          "Iago Vázquez",
          "Mohammed Saleh",
          "Ángel Miguel García-Vico",
          "Cristóbal J. Carmona"
        ],
        links: { doi: "#", scholar: "#", bibtex: "#" }
      },
      {
        title: "Application of Spiking Neural Networks and Traditional Artificial Neural Networks for Solar Radiation Forecasting in Photovoltaic Systems in Arab Countries",
        authors: [
          "Bahgat Ayasi",
          "Iago Vázquez",
          "Mohammed Saleh",
          "Ángel Miguel García-Vico",
          "Cristóbal J. Carmona"
        ],
        links: { doi: "#", scholar: "#", bibtex: "#" }
      },
      {
        title: "Application of Spiking Neural Networks and Traditional Artificial Neural Networks for Solar Radiation Forecasting in Photovoltaic Systems in Arab Countries",
        authors: [
          "Bahgat Ayasi",
          "Iago Vázquez",
          "Mohammed Saleh",
          "Ángel Miguel García-Vico",
          "Cristóbal J. Carmona"
        ],
        links: { doi: "#", scholar: "#", bibtex: "#" }
      },
      {
        title: "Application of Spiking Neural Networks and Traditional Artificial Neural Networks for Solar Radiation Forecasting in Photovoltaic Systems in Arab Countries",
        authors: [
          "Bahgat Ayasi",
          "Iago Vázquez",
          "Mohammed Saleh",
          "Ángel Miguel García-Vico",
          "Cristóbal J. Carmona"
        ],
        links: { doi: "#", scholar: "#", bibtex: "#" }
      },
    ]
  },
  {
    year: 2024,
    items: [
    ]
  }
];
---
<BaseLayout>
  <section class="max-w-full bg-white shadow-md rounded-lg">
    <TopUtility />
    <Header />
  </section>
  <section class="mt-10 max-w-full bg-white shadow-md">
    <NavBar />
  </section>

  <section
    class="w-full content-wrap bg-white shadow-md
           max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10 mt-10"
  >
    <div class="mb-8 relative inline-block w-full text-center py-2">
      <h2 class="text-2xl font-bold text-[#231F20]">Investigación</h2>
      <span
        class="absolute left-1/2 bottom-0 w-20 h-1 bg-[#006D38]
               -translate-x-1/2"
      ></span>
    </div>

    {researchGroups.map(group => (
      <YearGroup group={group} />
    ))}
  </section>
</BaseLayout>

<script type="module" client:load>
  document.querySelectorAll('div[id^="year-"]').forEach(container => {
    const details   = container.closest('details');
    const items     = Array.from(container.querySelectorAll('.year-item'));
    const btn       = document.getElementById(`load-more-${container.id}`);
    const threshold = parseInt(container.dataset.threshold || '0', 10);
    let visible     = threshold;

    function reset() {
      visible = threshold;
      items.forEach((el, i) => {
        el.classList.toggle('hidden', i >= visible);
      });
      if (btn) {
        btn.style.display = visible < items.length ? '' : 'none';
      }
    }

    reset();

    if (btn) {
      btn.addEventListener('click', () => {
        for (let i = visible; i < visible + threshold && i < items.length; i++) {
          items[i].classList.remove('hidden');
        }
        visible += threshold;
        if (visible >= items.length) btn.remove();
      });
    }

    if (details) {
      details.addEventListener('toggle', () => {
        if (details.open) reset();
      });
    }
  });
</script>
