---

---

<div class="bg-slate-800 text-slate-200 text-xs">
  <div class="container mx-auto px-4 flex justify-end gap-4 py-1">
    <a href="/lang" class="hidden sm:inline hover:text-white transition-colors"
      >ES</a
    >
    <button
      id="adminToggle"
      class="cursor-pointer bg-transparent border-none text-inherit px-2 py-1 rounded hover:bg-slate-700 transition-all duration-200"
    >
      Admin
    </button>
  </div>
</div>

<script>
  import { adminState, logoutAdmin } from "@/stores/auth";

  const adminToggle = document.getElementById("adminToggle");

  // Nos suscribimos a Atom para actualizar el texto del boton
  adminState.subscribe((state) => {
    if (adminToggle != null) {
      if (state.isAdmin) {
        adminToggle.textContent = state.username
          ? `${state.username}`
          : "Admin Activo";
        adminToggle.classList.add("text-green-400", "font-bold");
      } else {
        adminToggle.textContent = "Admin";
        adminToggle.classList.add("text-green-400", "font-bold");
      }
    }else{
      console.error("El boton Admin no se ha actualizado correctamente"); 
    }
  });

  // El click ahora llama a las funciones del store

  adminToggle?.addEventListener('click', ()=>{
    const currentState = adminState.get(); 

    if(currentState.isAdmin){
      // Logout
      logoutAdmin(); 
      adminToggle.textContent = 'Sesion cerrada'; 
      setTimeout(() => window.location.reload(), 1000); 
    }else{
      window.location.href = '/admin-login';
    }
  })

</script>
