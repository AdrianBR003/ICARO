---
// No necesitamos props ni imports de lógica aquí, todo va por JS
---

<div class="flex justify-center mb-8 relative z-30">
  <button
    id="addProjectButton"
    type="button"
    class="admin-control hidden flex items-center gap-2 bg-[#006D38] hover:bg-[#005229] text-white font-bold py-2.5 px-6 rounded-lg shadow-md transition-all duration-200 transform hover:-translate-y-0.5"
  >
    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clip-rule="evenodd" />
    </svg>
    Nuevo Proyecto
  </button>
</div>

<div
  id="add-project-modal"
  class="hidden fixed inset-0 z-[9999] flex items-center justify-center p-4 fade-in"
  role="dialog"
  aria-modal="true"
  aria-labelledby="modal-title"
>
  <div class="modal-overlay absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity"></div>

  <div class="relative bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto transform transition-all">
    
    <div class="p-8">
      <div class="flex justify-between items-center mb-6 pb-4 border-b border-gray-100">
        <h3 id="modal-title" class="text-2xl font-bold text-gray-800">
          Nuevo Proyecto
        </h3>
        <button type="button" class="close-add-modal text-gray-400 hover:text-red-500 transition-colors p-1 rounded-full hover:bg-red-50">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>

      <form id="add-project-form" class="space-y-6">
        
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
          <div class="md:col-span-1">
            <label class="block mb-2 text-sm font-semibold text-gray-700">ID del Proyecto *</label>
            <input 
              type="text" 
              name="id" 
              required 
              class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#006D38] focus:border-[#006D38] outline-none transition-all placeholder-gray-400"
              placeholder="Ej: PRJ-2025" 
            />
          </div>
          <div class="md:col-span-3">
            <label class="block mb-2 text-sm font-semibold text-gray-700">Título del Proyecto *</label>
            <input 
              type="text" 
              name="title" 
              required 
              class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#006D38] focus:border-[#006D38] outline-none transition-all"
              placeholder="Título descriptivo..." 
            />
          </div>
        </div>

        <div>
          <label class="block mb-2 text-sm font-semibold text-gray-700">Descripción *</label>
          <textarea 
            name="description" 
            rows="3" 
            required 
            class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#006D38] focus:border-[#006D38] outline-none transition-all resize-none"
            placeholder="Resumen de los objetivos y alcance del proyecto..."
          ></textarea>
        </div>

        <div>
          <label class="block mb-2 text-sm font-semibold text-gray-700">Participantes *</label>
          <input 
            type="text" 
            name="participants" 
            required 
            class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#006D38] focus:border-[#006D38] outline-none transition-all"
            placeholder="Nombre 1, Nombre 2, Nombre 3 (separados por comas)" 
          />
          <p class="mt-1 text-xs text-gray-500">Separa los nombres con comas.</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label class="block mb-2 text-sm font-semibold text-gray-700">Fecha de Inicio *</label>
            <input 
              type="date" 
              name="firstProjectDate" 
              required 
              class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#006D38] focus:border-[#006D38] outline-none transition-all" 
            />
          </div>
          <div>
            <label class="block mb-2 text-sm font-semibold text-gray-700">Fecha de Finalización</label>
            <input 
              type="date" 
              name="secondProjectDate" 
              class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#006D38] focus:border-[#006D38] outline-none transition-all" 
            />
          </div>
        </div>

        <div class="bg-gray-50 p-4 rounded-lg border border-gray-100">
          <label class="block mb-2 text-sm font-semibold text-gray-700">Etiquetas</label>
          <div id="tagsContainer" class="flex flex-wrap gap-2 mb-3 min-h-[32px]"></div>
          <div class="flex gap-2">
            <input 
              type="text" 
              id="tagInput" 
              class="flex-grow px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#006D38] outline-none" 
              placeholder="Escribe una etiqueta y pulsa Enter o +" 
            />
            <button 
              type="button" 
              id="addTagBtn" 
              class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-bold transition-colors"
            >
              +
            </button>
          </div>
        </div>

        <div class="bg-gray-50 p-4 rounded-lg border border-gray-100">
          <label class="block mb-2 text-sm font-semibold text-gray-700">IDs de Trabajos Relacionados</label>
          <div id="workIdsContainer" class="flex flex-wrap gap-2 mb-3 min-h-[32px]"></div>
          <div class="flex gap-2">
            <input 
              type="text" 
              id="workIdInput" 
              class="flex-grow px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#006D38] outline-none" 
              placeholder="Escribe un ID y pulsa Enter o +" 
            />
            <button 
              type="button" 
              id="addWorkIdBtn" 
              class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-bold transition-colors"
            >
              +
            </button>
          </div>
        </div>

        <div class="flex justify-end gap-4 pt-6 border-t border-gray-100 mt-6">
          <button 
            type="button" 
            class="close-add-modal px-6 py-2.5 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 font-medium transition-colors"
          >
            Cancelar
          </button>
          <button 
            type="submit" 
            class="px-8 py-2.5 bg-[#006D38] text-white rounded-lg hover:bg-[#005229] font-bold shadow-md hover:shadow-lg transition-all transform hover:-translate-y-0.5"
          >
            Guardar
          </button>
        </div>

      </form>
    </div>
  </div>
</div>

<script>
  // Importamos la lógica directa (sin Store ni triggers externos)
  import { initializeAddModal } from "@/utils/projects/modals/projectsAddModal";

  // Aseguramos que se cargue cuando el DOM esté listo
  document.addEventListener("DOMContentLoaded", () => {
    initializeAddModal();
  });
</script>

<style>
  /* Animación simple de entrada */
  .fade-in {
    animation: fadeIn 0.2s ease-out;
  }
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
</style>