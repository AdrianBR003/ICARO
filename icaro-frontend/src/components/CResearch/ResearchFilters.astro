---
interface ResearchGroup {
  year: number;
}

const { tagCategories, projectCategories, researchGroups, mostRecentYear } = Astro.props as {
  tagCategories: string[];
  projectCategories: string[];
  researchGroups: ResearchGroup[];
  mostRecentYear: number;
};
---

<div class="mb-10">
  <div class="relative max-w-full">
    <span
      class="absolute inset-y-0 left-0 flex items-center pl-4 text-gray-500"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 20 20"
        fill="currentColor"
        class="w-5 h-5"
      >
        <path
          fill-rule="evenodd"
          d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z"
          clip-rule="evenodd"></path>
      </svg>
    </span>
    <input
      id="search-input"
      type="search"
      placeholder="Buscar publicaciones por título o autor..."
      class="w-full pl-11 pr-4 py-3 border border-gray-300 rounded-lg text-gray-800 focus:ring-2 focus:ring-cyan-400 focus:border-cyan-400 transition"
    />
  </div>
</div>

<div class="mb-10">
  <div class="mb-4">
    <div class="flex flex-wrap gap-3 items-center">
      {
        Array.from(tagCategories).map((category) => (
          <button
            type="button"
            class="category-btn bg-white text-gray-800 px-4 py-2 rounded-md font-medium border border-gray-200 shadow-sm hover:bg-[#1D293D] hover:text-white transition-all duration-300 flex items-center"
            data-category={category}
            data-type="tag"
          >
            <span class="filter-content flex items-center gap-2">
              <svg
                class="close-icon hidden w-3 h-3"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M6 18L18 6M6 6l12 12"
                />
              </svg>
              <span>{category}</span>
            </span>
          </button>
        ))
      }
    </div>
  </div>

  <div class="border-t border-gray-200 pt-4">
    <div class="flex flex-wrap gap-3 items-center">
      {
        Array.from(projectCategories).map((category) => (
          <button
            type="button"
            class="category-btn project-btn bg-blue-50 text-blue-800 px-4 py-2 rounded-md font-medium border border-blue-200 shadow-sm hover:bg-blue-100 transition-all duration-300 flex items-center"
            data-category={category}
            data-type="project"
          >
            <span class="filter-content flex items-center gap-2">
              <svg
                class="close-icon hidden w-3 h-3"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M6 18L18 6M6 6l12 12"
                />
              </svg>
              <span>{category}</span>
            </span>
          </button>
        ))
      }
    </div>
  </div>
</div>

<div class="flex justify-between items-center mb-6">
  <button
    id="addButton"
    class="hidden bg-[#006D38] hover:bg-[#005229] text-white font-bold py-2 px-4 rounded flex items-center edit-btn"
  >
    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clip-rule="evenodd" />
    </svg>
    Añadir Publicacion
  </button>

  <div class="flex items-center gap-3 ml-auto">
    <span class="text-sm text-gray-600">Año:</span>
    <div class="relative">
      <select
        id="year-filter"
        class="appearance-none bg-white border border-gray-300 rounded-md px-3 py-1 pr-7 text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500 transition cursor-pointer"
      >
        <option value="all">Todos</option>
        {
          researchGroups.map(({ year }) => (
            <option value={year} selected={year === mostRecentYear}>
              {year}
            </option>
          ))
        }
      </select>
      <div
        class="pointer-events-none absolute inset-y-0 right-1 flex items-center px-1 text-gray-500"
      >
        <svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
          <path
            fill-rule="evenodd"
            d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
            clip-rule="evenodd"></path>
        </svg>
      </div>
    </div>
  </div>
</div>

<style>
  .category-btn {
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
  }
  .category-btn:hover:not(.active-filter) {
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }
  .category-btn.active-filter {
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
  }
  .close-icon {
    transition: opacity 0.2s ease;
  }
  .filter-content {
    transition: margin 0.2s ease;
  }
  .category-btn.active-filter .filter-content {
    margin-left: 4px;
  }

  .project-btn {
    background-color: #effdf5;
    color: #1d293d;
    border: 1px solid #bfe5d1;
  }
  .project-btn:hover {
    background-color: #d9fbe5;
  }
  .project-btn.active-filter {
    background-color: #006d38;
    color: white;
    border-color: white;
  }

  #year-filter {
    -webkit-appearance: none;
    -moz-appearance: none;
    background-image: none;
    padding-right: 1.75rem;
  }
</style>